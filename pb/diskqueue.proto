syntax = "proto3";

package diskqueue;

service Diskqueue {
    rpc Publish     (PublishRequest)         returns (PublishReply)             {}
    rpc MPublish    (stream PublishRequest)  returns (PublishReply)             {}
    rpc Subscribe   (SubscribeRequest)       returns (SubscribeReply)           {}
    rpc Cancel      (CancelRequest)          returns (CancelReply)              {}
    rpc Pull        (PullRequest)            returns (PullReply)                {}
    rpc KeepAlive   (KeepAliveRequest)       returns (stream KeepAliveReply)    {}
    rpc Ack         (AckRequest)             returns (AckReply)                 {}
}

message Message {
    uint64  ID   = 1;
    bytes   data = 2;
    int64   timestamp = 3;
}

message PublishRequest {
    string topic = 1;
    bytes  data  = 2; 
}

message PublishReply {
}

message SubscribeRequest {
    string topic    = 1;
    string channel  = 2;
    uint64 msgID    = 3;
}

message SubscribeReply {
}

message CancelRequest {
}

message CancelReply {
}

message PullRequest {
}

message PullReply {
    Message message = 1;
}

message KeepAliveRequest {
}

message KeepAliveReply {
}

message AckRequest {
    uint64 msgID = 1;
}

message AckReply {
}
