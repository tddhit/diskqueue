syntax = "proto3";

package diskqueue;

service Diskqueue {
    rpc Publish     (PublishRequest)         returns (PublishReply)             {}
    rpc MPublish    (stream PublishRequest)  returns (PublishReply)             {}
    rpc Pull        (PullRequest)            returns (PullReply)                {}
    rpc Ack         (AckRequest)             returns (AckReply)                 {}
}

message Message {
    uint64  ID   = 1;
    bytes   data = 2;
    int64   timestamp = 3;
}

message PublishRequest {
    string topic = 1;
    bytes  data  = 2; 
}

message PublishReply {
}

message PullRequest {
    string topic = 1;
    bool   ack = 2;
}

message PullReply {
    Message message = 1;
}

message AckRequest {
    string topic = 1;
    uint64 msgID = 2;
}

message AckReply {
}
